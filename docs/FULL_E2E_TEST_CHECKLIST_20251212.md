# K-Jarvis ì „ì²´ E2E í†µí•© í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ì‘ì„±ì¼**: 2024-12-12  
**ì´ê´„**: Orchestrator Team  
**ì°¸ì—¬íŒ€**: K-Auth, Orchestrator, MCPHub, Agent

---

## ğŸ“Š í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìš”ì•½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         K-Jarvis ì „ì²´ í”Œë¡œìš°                                 â”‚
â”‚                                                                             â”‚
â”‚  [1ë‹¨ê³„] K-Auth ê³„ì • ìƒì„± â†’ SSO ë¡œê·¸ì¸                                       â”‚
â”‚     â†“                                                                       â”‚
â”‚  [2ë‹¨ê³„] Orchestrator ë¡œê·¸ì¸ + JWT ë°œê¸‰ (kauth_user_id í¬í•¨)                 â”‚
â”‚     â†“                                                                       â”‚
â”‚  [3ë‹¨ê³„] MCPHub ë¡œê·¸ì¸ + ì„œë¹„ìŠ¤ í† í° ë“±ë¡                                    â”‚
â”‚     â†“                                                                       â”‚
â”‚  [4ë‹¨ê³„] Agent í˜¸ì¶œ (X-MCPHub-User-Id í—¤ë” ì „ë‹¬)                             â”‚
â”‚     â†“                                                                       â”‚
â”‚  [5ë‹¨ê³„] MCPHubì—ì„œ ì‚¬ìš©ìë³„ í† í° ì ìš© â†’ ì‹¤ì œ API í˜¸ì¶œ                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ì„œë²„ ê¸°ë™ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ì„œë²„

| # | ì„œë¹„ìŠ¤ | í¬íŠ¸ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|--------|:----:|:----:|:----:|
| 1 | PostgreSQL | 5432 | Orchestrator | â¬œ |
| 2 | K-Auth | 4002 | Orchestrator | â¬œ |
| 3 | Orchestrator Backend | 4001 | Orchestrator | â¬œ |
| 4 | Orchestrator Frontend | 4000 | Orchestrator | â¬œ |
| 5 | MCPHub | 3000 | MCPHub | â¬œ |
| 6 | Confluence Agent | 5010 | Agent | â¬œ |
| 7 | Jira Agent | 5011 | Agent | â¬œ |
| 8 | GitHub Agent | 5012 | Agent | â¬œ |

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1ë‹¨ê³„: K-Auth ê³„ì • ìƒì„± ë° SSO ë¡œê·¸ì¸

| # | í…ŒìŠ¤íŠ¸ í•­ëª© | ì˜ˆìƒ ê²°ê³¼ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|------------|----------|:----:|:----:|
| 1.1 | K-Auth ì‹ ê·œ ì‚¬ìš©ì ë“±ë¡ | ì‚¬ìš©ì ìƒì„± ì„±ê³µ | K-Auth | â¬œ |
| 1.2 | K-Auth ì§ì ‘ ë¡œê·¸ì¸ | ë¡œê·¸ì¸ ì„±ê³µ | K-Auth | â¬œ |
| 1.3 | OAuth í´ë¼ì´ì–¸íŠ¸ (K-Jarvis) ë“±ë¡ í™•ì¸ | í´ë¼ì´ì–¸íŠ¸ ì¡´ì¬ | K-Auth | â¬œ |

### 2ë‹¨ê³„: Orchestrator SSO ë¡œê·¸ì¸

| # | í…ŒìŠ¤íŠ¸ í•­ëª© | ì˜ˆìƒ ê²°ê³¼ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|------------|----------|:----:|:----:|
| 2.1 | K-Auth SSO ë²„íŠ¼ í´ë¦­ | K-Auth ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ | Orchestrator | â¬œ |
| 2.2 | K-Auth ë¡œê·¸ì¸ í›„ ì½œë°± | JWT í† í° ë°œê¸‰, kauth_user_id í¬í•¨ | Orchestrator | â¬œ |
| 2.3 | /api/auth/me í˜¸ì¶œ | ì‚¬ìš©ì ì •ë³´ ë°˜í™˜ | Orchestrator | â¬œ |
| 2.4 | ëŒ€í™” ì´ë ¥ ë¡œë“œ | ì‚¬ìš©ìë³„ ëŒ€í™” ì´ë ¥ í‘œì‹œ | Orchestrator | â¬œ |

### 3ë‹¨ê³„: MCPHub ì—°ë™ (ì‚¬ìš©ì í† í° ë“±ë¡)

| # | í…ŒìŠ¤íŠ¸ í•­ëª© | ì˜ˆìƒ ê²°ê³¼ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|------------|----------|:----:|:----:|
| 3.1 | MCPHub K-Auth SSO ë¡œê·¸ì¸ | MCPHub ì‚¬ìš©ì ìƒì„±/ë¡œê·¸ì¸ | MCPHub | â¬œ |
| 3.2 | MCPHub Key ë°œê¸‰ | API Key ë°œê¸‰ ì™„ë£Œ | MCPHub | â¬œ |
| 3.3 | ì„œë¹„ìŠ¤ í† í° ë“±ë¡ (Confluence) | í† í° ì €ì¥ ì™„ë£Œ | MCPHub | â¬œ |
| 3.4 | ì„œë¹„ìŠ¤ í† í° ë“±ë¡ (Jira) | í† í° ì €ì¥ ì™„ë£Œ | MCPHub | â¬œ |
| 3.5 | ì„œë¹„ìŠ¤ í† í° ë“±ë¡ (GitHub) | í† í° ì €ì¥ ì™„ë£Œ | MCPHub | â¬œ |
| 3.6 | MCP ì„œë²„ êµ¬ë… | ì„œë²„ í™œì„±í™” | MCPHub | â¬œ |

### 4ë‹¨ê³„: Agent ë¼ìš°íŒ… ë° í˜¸ì¶œ

| # | í…ŒìŠ¤íŠ¸ í•­ëª© | ì˜ˆìƒ ê²°ê³¼ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|------------|----------|:----:|:----:|
| 4.1 | Agent ë“±ë¡ í™•ì¸ | 3ê°œ Agent ì˜¨ë¼ì¸ | Orchestrator | â¬œ |
| 4.2 | Confluence ê´€ë ¨ ì§ˆë¬¸ ë¼ìš°íŒ… | Confluence Agent ì„ íƒ | Orchestrator | â¬œ |
| 4.3 | Jira ê´€ë ¨ ì§ˆë¬¸ ë¼ìš°íŒ… | Jira Agent ì„ íƒ | Orchestrator | â¬œ |
| 4.4 | GitHub ê´€ë ¨ ì§ˆë¬¸ ë¼ìš°íŒ… | GitHub Agent ì„ íƒ | Orchestrator | â¬œ |
| 4.5 | X-MCPHub-User-Id í—¤ë” ì „ë‹¬ í™•ì¸ | Agentì—ì„œ í—¤ë” ìˆ˜ì‹  | Agent | â¬œ |

### 5ë‹¨ê³„: MCPHub ì„œë¹„ìŠ¤ í† í° ì ìš©

| # | í…ŒìŠ¤íŠ¸ í•­ëª© | ì˜ˆìƒ ê²°ê³¼ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|------------|----------|:----:|:----:|
| 5.1 | Agent â†’ MCPHub í—¤ë” ì „ë‹¬ | X-MCPHub-User-Id ì „ë‹¬ | Agent | â¬œ |
| 5.2 | MCPHub ì‚¬ìš©ì í† í° ì¡°íšŒ | kauth_user_idë¡œ í† í° ë¡œë“œ | MCPHub | â¬œ |
| 5.3 | Confluence API í˜¸ì¶œ | ì‹¤ì œ ê²€ìƒ‰ ê²°ê³¼ ë°˜í™˜ | MCPHub | â¬œ |
| 5.4 | Jira API í˜¸ì¶œ | ì‹¤ì œ ì´ìŠˆ ëª©ë¡ ë°˜í™˜ | MCPHub | â¬œ |
| 5.5 | GitHub API í˜¸ì¶œ | ì‹¤ì œ PR/ì´ìŠˆ ë°˜í™˜ | MCPHub | â¬œ |

### 6ë‹¨ê³„: ì‘ë‹µ ìƒì„± ë° í‘œì‹œ

| # | í…ŒìŠ¤íŠ¸ í•­ëª© | ì˜ˆìƒ ê²°ê³¼ | ë‹´ë‹¹ | ìƒíƒœ |
|:-:|------------|----------|:----:|:----:|
| 6.1 | LLM ì‘ë‹µ ìƒì„± | ì •í™•í•œ ë‹µë³€ ìƒì„± | Agent | â¬œ |
| 6.2 | Orchestrator ì‘ë‹µ ìˆ˜ì‹  | A2A ì‘ë‹µ íŒŒì‹± | Orchestrator | â¬œ |
| 6.3 | Frontend ì‘ë‹µ í‘œì‹œ | UIì— ë‹µë³€ í‘œì‹œ | Orchestrator | â¬œ |
| 6.4 | ëŒ€í™” ì´ë ¥ ì €ì¥ | DBì— ëŒ€í™” ì €ì¥ | Orchestrator | â¬œ |

---

## ğŸ¯ í•µì‹¬ ê²€ì¦ í¬ì¸íŠ¸

### 1. ë°©ì•ˆ C (MCPHub Proxy) ê²€ì¦

```
âœ… Orchestrator JWTì— kauth_user_id í¬í•¨
âœ… Orchestrator â†’ Agent: X-MCPHub-User-Id í—¤ë” ì „ë‹¬
âœ… Agent â†’ MCPHub: X-MCPHub-User-Id í—¤ë” ì „ë‹¬
âœ… MCPHub: kauth_user_idë¡œ ì‚¬ìš©ì ì„œë¹„ìŠ¤ í† í° ì¡°íšŒ/ì ìš©
```

### 2. ì‚¬ìš©ì ë¶„ë¦¬ ê²€ì¦

```
âœ… ì‚¬ìš©ì Aì˜ í† í°ìœ¼ë¡œ API í˜¸ì¶œ ì‹œ Aì˜ ê¶Œí•œ ì ìš©
âœ… ëŒ€í™” ì´ë ¥ì´ ì‚¬ìš©ìë³„ë¡œ ë¶„ë¦¬
âœ… ì—ì´ì „íŠ¸ ì„¤ì •ì´ ì‚¬ìš©ìë³„ë¡œ ë¶„ë¦¬
```

---

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ (testuser ê³„ì •)

### Confluence ê²€ìƒ‰ í…ŒìŠ¤íŠ¸

```bash
curl -s -X POST http://localhost:5010/tasks/send \
  -H "Content-Type: application/json" \
  -H "X-Request-Id: e2e-test-001" \
  -H "X-MCPHub-User-Id: testuser" \
  -d '{
    "jsonrpc":"2.0",
    "id":"test",
    "method":"message/send",
    "params":{
      "message":{
        "role":"user",
        "parts":[{"type":"text","text":"Confluenceì—ì„œ MCPHub ê´€ë ¨ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•´ì¤˜"}]
      },
      "contextId":"test-context"
    }
  }'
```

### MCPHub ë„êµ¬ ëª©ë¡ í™•ì¸

```bash
curl -X POST "http://localhost:3000/mcp" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer mcphub_0a7fb098aa06396213ff4e317f0d80694a1d5e0e065828c9b3aa684a8a32ff43" \
  -H "X-MCPHub-User-Id: testuser" \
  -d '{"jsonrpc":"2.0","id":1,"method":"tools/list","params":{}}'
```

---

## ğŸ“Š íŒ€ë³„ í™•ì¸ ìƒíƒœ

| íŒ€ | êµ¬í˜„ ìƒíƒœ | í…ŒìŠ¤íŠ¸ ìƒíƒœ | ë¹„ê³  |
|----|:--------:|:----------:|------|
| K-Auth | âœ… ì™„ë£Œ | âœ… ì™„ë£Œ | SSO ë¡œê·¸ì¸ ê²€ì¦ë¨ |
| Orchestrator | âœ… ì™„ë£Œ | âœ… ì™„ë£Œ | X-MCPHub-User-Id ì „ë‹¬ êµ¬í˜„ |
| MCPHub | âœ… ì™„ë£Œ | âœ… ì™„ë£Œ | ë™ì  ì„œë²„ ì—°ê²°, ì‚¬ìš©ì í† í° ì ìš© |
| Agent | âœ… ì™„ë£Œ | âœ… ì™„ë£Œ | X-MCPHub-User-Id ì „ë‹¬ ê²€ì¦ë¨ |

---

## ğŸš€ í…ŒìŠ¤íŠ¸ ì‹œì‘!

**ëª¨ë“  ì„œë²„ê°€ ê¸°ë™ë˜ë©´ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ë”°ë¼ ìˆœì°¨ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì§„í–‰**

---

*Orchestrator Team*  
2024-12-12


