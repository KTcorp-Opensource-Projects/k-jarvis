# Orchestrator â†’ Agent Team: í† í° ì•„í‚¤í…ì²˜ í™•ì¸ ì™„ë£Œ

**ì‘ì„±ì¼**: 2024-12-12  
**ì‘ì„±íŒ€**: Orchestrator Team  
**ì°¸ì¡° ë¬¸ì„œ**: 
- `TO_ALL_TEAMS_TOKEN_ARCHITECTURE_QUESTION_20251212.md` (Agent ì§ˆë¬¸)
- `TO_AGENT_TOKEN_ARCHITECTURE_ANSWER_20251212.md` (MCPHub ë‹µë³€)

---

## âœ… ê²°ë¡ : ì‹œë‚˜ë¦¬ì˜¤ Aê°€ ì •ë‹µì…ë‹ˆë‹¤

**MCPHub íŒ€ì˜ ë‹µë³€ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. Agent íŒ€ì˜ í˜„ì¬ êµ¬í˜„ì´ ì •í™•í•©ë‹ˆë‹¤!**

```
âœ… ì‹œë‚˜ë¦¬ì˜¤ A: Agent ì „ìš© í‚¤ + X-MCPHub-User-Id (í˜„ì¬ êµ¬í˜„ ìœ ì§€)
âŒ ì‹œë‚˜ë¦¬ì˜¤ B: ì‚¬ìš©ìë³„ MCPHub Key ì „ë‹¬ (ë¶ˆí•„ìš”)
```

---

## ğŸ“Š ìµœì¢… í™•ì •ëœ í† í° í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         K-Jarvis í† í° í”Œë¡œìš° (í™•ì •)                          â”‚
â”‚                                                                             â”‚
â”‚  User (K-Auth ë¡œê·¸ì¸)                                                       â”‚
â”‚      â†“                                                                      â”‚
â”‚  Orchestrator                                                               â”‚
â”‚      â”‚ JWT: { kauth_user_id: "uuid-123" }                                  â”‚
â”‚      â†“                                                                      â”‚
â”‚  Agent (Confluence/Jira/GitHub)                                            â”‚
â”‚      â”‚ Headers:                                                             â”‚
â”‚      â”‚   Authorization: Bearer {AGENT_MCPHUB_KEY}  â† ê³ ì • (Agent ì „ìš©)     â”‚
â”‚      â”‚   X-MCPHub-User-Id: "uuid-123"              â† Orchestratorì—ì„œ ì „ë‹¬  â”‚
â”‚      â†“                                                                      â”‚
â”‚  MCPHub                                                                     â”‚
â”‚      â”‚ 1ï¸âƒ£ Agent í‚¤ë¡œ API ì¸ì¦                                              â”‚
â”‚      â”‚ 2ï¸âƒ£ X-MCPHub-User-Idë¡œ ì‚¬ìš©ì ì‹ë³„                                   â”‚
â”‚      â”‚ 3ï¸âƒ£ í•´ë‹¹ ì‚¬ìš©ìì˜ ì„œë¹„ìŠ¤ í† í° ë¡œë“œ (Jira/Confluence/GitHub)          â”‚
â”‚      â”‚ 4ï¸âƒ£ ì„œë¹„ìŠ¤ í† í°ìœ¼ë¡œ MCP ì„œë²„ì— ìš”ì²­                                  â”‚
â”‚      â†“                                                                      â”‚
â”‚  MCP Server â†’ ì™¸ë¶€ API (Atlassian, GitHub)                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” í† í° ì—­í•  ì •ë¦¬

| í† í°/í—¤ë” | ìš©ë„ | ëˆ„ê°€ ê´€ë¦¬ |
|----------|------|----------|
| `Authorization: Bearer {AGENT_KEY}` | Agent â†’ MCPHub ì¸ì¦ | Agent (.env ê³ ì •) |
| `X-MCPHub-User-Id` | ì‚¬ìš©ì ì‹ë³„ (ì„œë¹„ìŠ¤ í† í° ì¡°íšŒ) | Orchestrator â†’ Agent ì „ë‹¬ |
| ì„œë¹„ìŠ¤ í† í° (Jira/Confluence) | ì™¸ë¶€ API ì¸ì¦ | MCPHubê°€ ì‚¬ìš©ìë³„ë¡œ ê´€ë¦¬ |

---

## âœ… Agent íŒ€ í™•ì¸ ì‚¬í•­

### í˜„ì¬ êµ¬í˜„ ìœ ì§€ âœ…

```python
# í˜„ì¬ êµ¬í˜„ ê·¸ëŒ€ë¡œ OK!
headers = {
    "Authorization": f"Bearer {AGENT_MCPHUB_KEY}",  # .envì—ì„œ ì½ì€ ê³ ì • í‚¤
    "X-MCPHub-User-Id": mcphub_user_id               # Orchestratorì—ì„œ ì „ë‹¬ë°›ì€ ê°’
}
```

### ì¶”ê°€ êµ¬í˜„ ë¶ˆí•„ìš” âŒ

- `X-MCPHub-User-Key` í—¤ë” ì²˜ë¦¬ **ë¶ˆí•„ìš”**
- ì‚¬ìš©ìë³„ MCPHub Key ì „ë‹¬ **ë¶ˆí•„ìš”**

---

## ğŸ§ª í†µí•© í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ìƒíƒœ

### ì „ì²´ íŒ€ ìƒíƒœ

| íŒ€ | êµ¬í˜„ | í…ŒìŠ¤íŠ¸ | ìƒíƒœ |
|----|:----:|:------:|:----:|
| K-Auth | âœ… | âœ… | ğŸŸ¢ Ready |
| Orchestrator | âœ… | âœ… | ğŸŸ¢ Ready |
| MCPHub | âœ… | âœ… | ğŸŸ¢ Ready |
| Agent | âœ… | âœ… | ğŸŸ¢ Ready |

### Orchestrator ì¤€ë¹„ ì™„ë£Œ í•­ëª©

- [x] K-Auth SSO ë¡œê·¸ì¸ êµ¬í˜„
- [x] JWTì— `kauth_user_id` í¬í•¨
- [x] Agent í˜¸ì¶œ ì‹œ `X-MCPHub-User-Id` í—¤ë” ì „ë‹¬
- [x] ì‚¬ìš©ìë³„ ëŒ€í™” ì´ë ¥ ë¶„ë¦¬

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„: í†µí•© í…ŒìŠ¤íŠ¸ ì§„í–‰

ëª¨ë“  ì„œë²„ ê¸°ë™ í›„ ì „ì²´ E2E í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

### ì„œë²„ ê¸°ë™ ì²´í¬ë¦¬ìŠ¤íŠ¸

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ë‹´ë‹¹ |
|--------|:----:|:----:|
| PostgreSQL | 5432 | Orchestrator |
| K-Auth | 4002 | Orchestrator |
| Orchestrator Backend | 4001 | Orchestrator |
| Orchestrator Frontend | 4000 | Orchestrator |
| MCPHub | 3000 | MCPHub |
| Confluence Agent | 5010 | Agent |
| Jira Agent | 5011 | Agent |
| GitHub Agent | 5012 | Agent |

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

1. K-Auth ì‹ ê·œ ê³„ì • ìƒì„±
2. Orchestrator K-Auth SSO ë¡œê·¸ì¸
3. MCPHub K-Auth SSO ë¡œê·¸ì¸ + ì„œë¹„ìŠ¤ í† í° ë“±ë¡
4. Orchestratorì—ì„œ "Confluenceì—ì„œ MCPHub ë¬¸ì„œ ê²€ìƒ‰í•´ì¤˜" ìš”ì²­
5. ì •ìƒ ì‘ë‹µ í™•ì¸

---

## ğŸ“ ìš”ì•½

**Agent íŒ€ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€:**

| ì§ˆë¬¸ | ë‹µë³€ |
|------|------|
| ì‚¬ìš©ìë§ˆë‹¤ ë‹¤ë¥¸ MCPHub Keyê°€ ìˆë‚˜ìš”? | ìˆì§€ë§Œ, AgentëŠ” Agent ì „ìš© Key ì‚¬ìš© |
| í˜„ì¬ ë°©ì•ˆ C í”Œë¡œìš°ê°€ ë§ë‚˜ìš”? | âœ… ë§ìŠµë‹ˆë‹¤ |
| ì‹œë‚˜ë¦¬ì˜¤ A vs B? | **ì‹œë‚˜ë¦¬ì˜¤ Aê°€ ì •ë‹µ** |

**ê²°ë¡ : í˜„ì¬ Agent êµ¬í˜„ ë³€ê²½ ì—†ì´ í†µí•© í…ŒìŠ¤íŠ¸ ì§„í–‰!** ğŸš€

---

*Orchestrator Team*  
2024-12-12

