# 🔴 모든 팀 필독: K-Auth 역할 및 Admin 계정 정책

**작성일**: 2024-12-12  
**작성팀**: Orchestrator Team  
**중요도**: 🔴 매우 높음 (아키텍처 원칙)

---

## 📋 핵심 원칙

### K-Auth의 역할

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   K-Auth = 일반 사용자를 위한 SSO Identity Provider            │
│                                                                 │
│   ✅ 일반 사용자 회원가입/로그인                                │
│   ✅ OAuth 2.0 인증 제공                                        │
│   ✅ 여러 서비스 간 SSO 연동                                    │
│                                                                 │
│   ❌ 각 플랫폼의 Admin 계정 관리 X                              │
│   ❌ 관리자 권한 부여 X                                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🏗️ 플랫폼별 계정 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                    K-JARVIS ACCOUNT ARCHITECTURE                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                      K-AUTH                              │   │
│  │              (OAuth Identity Provider)                   │   │
│  │                                                          │   │
│  │  역할: 일반 사용자 SSO 인증 제공                         │   │
│  │  관리: 일반 사용자 계정만                                │   │
│  │                                                          │   │
│  │  ❌ Admin 계정과 무관                                    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            │                                    │
│              SSO 연동 (일반 사용자만)                           │
│                            │                                    │
│         ┌──────────────────┼──────────────────┐                │
│         ▼                  ▼                  ▼                │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐        │
│  │ ORCHESTRATOR│    │   MCPHUB    │    │   OTHER     │        │
│  │   PLATFORM  │    │   PLATFORM  │    │  SERVICES   │        │
│  ├─────────────┤    ├─────────────┤    ├─────────────┤        │
│  │             │    │             │    │             │        │
│  │ Admin 계정  │    │ Admin 계정  │    │ Admin 계정  │        │
│  │ (자체 관리) │    │ (자체 관리) │    │ (자체 관리) │        │
│  │     ↓       │    │     ↓       │    │     ↓       │        │
│  │ K-Auth 무관 │    │ K-Auth 무관 │    │ K-Auth 무관 │        │
│  │             │    │             │    │             │        │
│  │─────────────│    │─────────────│    │─────────────│        │
│  │             │    │             │    │             │        │
│  │ 일반 사용자 │    │ 일반 사용자 │    │ 일반 사용자 │        │
│  │     ↓       │    │     ↓       │    │     ↓       │        │
│  │ K-Auth SSO  │    │ K-Auth SSO  │    │ K-Auth SSO  │        │
│  │             │    │             │    │             │        │
│  └─────────────┘    └─────────────┘    └─────────────┘        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📝 계정 유형별 정리

### 1. Admin 계정 (각 플랫폼 자체 관리)

| 플랫폼 | Admin 계정 | 인증 방식 | K-Auth 연동 |
|--------|-----------|----------|:-----------:|
| Orchestrator | admin@k-jarvis.com | 로컬 DB | ❌ |
| MCPHub | (플랫폼 자체 admin) | 로컬 DB | ❌ |

### 2. 일반 사용자 (K-Auth SSO)

| 사용자 | 인증 방식 | 접근 가능 서비스 |
|--------|----------|-----------------|
| johndoe | K-Auth SSO | Orchestrator, MCPHub, 기타 |
| testuser | K-Auth SSO | Orchestrator, MCPHub, 기타 |

---

## ⚠️ 각 팀 주의사항

### Orchestrator 팀
- Admin 기능은 로컬 admin 계정으로만 접근
- K-Auth SSO 로그인 사용자는 일반 사용자 권한만 부여
- `is_admin: true`는 K-Auth가 아닌 자체 DB에서 관리

### MCPHub 팀
- Admin 대시보드는 플랫폼 자체 admin 계정으로만 접근
- K-Auth SSO 로그인 사용자는 일반 사용자로 처리
- API Key 관리자 권한은 자체적으로 부여

### Agent 팀
- Agent 등록/관리는 각 플랫폼의 Admin이 수행
- 일반 사용자는 Agent 사용만 가능

---

## 🎯 E2E 테스트 시 계정 구분

### Admin 작업 (K-Auth 미사용)
```
- Agent 등록/삭제
- 시스템 설정 변경
- 사용자 관리
→ 각 플랫폼의 자체 Admin 계정 사용
```

### 일반 사용자 작업 (K-Auth SSO)
```
- 서비스 로그인
- Agent 호출
- 서비스 토큰 등록
→ K-Auth 계정으로 SSO 로그인
```

---

## ✅ 이 원칙을 지켜야 하는 이유

1. **보안**: Admin 권한은 각 플랫폼이 독립적으로 관리
2. **책임 분리**: K-Auth는 인증만, 권한은 각 서비스가 관리
3. **유연성**: 플랫폼별로 다른 Admin 정책 적용 가능
4. **장애 격리**: K-Auth 장애 시에도 Admin 접근 가능

---

**이 원칙을 반드시 준수해주세요!**

---

*Orchestrator Team*  
*2024-12-12*

