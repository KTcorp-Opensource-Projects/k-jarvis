# Agent Orchestrator Database

## ğŸ“‹ ê°œìš”

Agent Orchestratorì˜ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë° ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

## ğŸ“¦ í•„ìˆ˜ ìš”êµ¬ì‚¬í•­

- PostgreSQL 14 ì´ìƒ
- psql í´ë¼ì´ì–¸íŠ¸

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
cd backend/db
./init_db.sh
```

### 2. ìˆ˜ë™ ì„¤ì •

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
createdb agent_orchestrator

# ìŠ¤í‚¤ë§ˆ ì ìš©
psql -d agent_orchestrator -f schema.sql
```

## ğŸ“Š í…Œì´ë¸” êµ¬ì¡°

### roles (ì—­í• )
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | SERIAL | Primary Key |
| name | VARCHAR(50) | ì—­í• ëª… (admin, user) |
| description | TEXT | ì—­í•  ì„¤ëª… |

### users (ì‚¬ìš©ì)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | UUID | Primary Key |
| username | VARCHAR(50) | ë¡œê·¸ì¸ ì•„ì´ë”” |
| email | VARCHAR(255) | ì´ë©”ì¼ |
| password_hash | VARCHAR(255) | bcrypt í•´ì‹œ |
| name | VARCHAR(100) | í‘œì‹œ ì´ë¦„ |
| role_id | INTEGER | FK â†’ roles.id |
| is_active | BOOLEAN | í™œì„±í™” ìƒíƒœ |

### user_sessions (ì„¸ì…˜)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | UUID | Primary Key |
| user_id | UUID | FK â†’ users.id |
| refresh_token | VARCHAR(500) | JWT refresh token |
| expires_at | TIMESTAMP | ë§Œë£Œ ì‹œê°„ |

### user_agent_preferences (ì—ì´ì „íŠ¸ ì„¤ì •)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | UUID | Primary Key |
| user_id | UUID | FK â†’ users.id |
| agent_id | VARCHAR(100) | ì—ì´ì „íŠ¸ ID |
| enabled | BOOLEAN | í™œì„±í™” ìƒíƒœ |

### conversations (ëŒ€í™”)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | UUID | Primary Key |
| user_id | UUID | FK â†’ users.id |
| title | VARCHAR(255) | ëŒ€í™” ì œëª© |

### messages (ë©”ì‹œì§€)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | UUID | Primary Key |
| conversation_id | UUID | FK â†’ conversations.id |
| role | VARCHAR(20) | user/assistant/system |
| content | TEXT | ë©”ì‹œì§€ ë‚´ìš© |
| agent_used | VARCHAR(100) | ì‚¬ìš©ëœ ì—ì´ì „íŠ¸ |
| task_id | VARCHAR(100) | A2A task ID |
| metadata | JSONB | ì¶”ê°€ ë©”íƒ€ë°ì´í„° |

### registered_agents (ë“±ë¡ëœ ì—ì´ì „íŠ¸)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | UUID | Primary Key |
| name | VARCHAR(255) | ì—ì´ì „íŠ¸ ì´ë¦„ |
| url | VARCHAR(500) | ì—ì´ì „íŠ¸ URL |
| skills | JSONB | ìŠ¤í‚¬ ëª©ë¡ |
| status | VARCHAR(20) | online/offline |

## ğŸ” ê¸°ë³¸ ê³„ì •

| ì—­í•  | Username | Password |
|------|----------|----------|
| Admin | admin | admin123 |

âš ï¸ **ì£¼ì˜**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ë°˜ë“œì‹œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì„¸ìš”!

## ğŸ”„ ê¶Œí•œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ADMIN                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… ì±„íŒ… ì‚¬ìš©                                                  â”‚
â”‚ âœ… ì—ì´ì „íŠ¸ ëª©ë¡ ì¡°íšŒ                                          â”‚
â”‚ âœ… ì—ì´ì „íŠ¸ í™œì„±í™”/ë¹„í™œì„±í™”                                     â”‚
â”‚ âœ… ì—ì´ì „íŠ¸ ë“±ë¡ (ì¶”ê°€)                                        â”‚
â”‚ âœ… ì—ì´ì „íŠ¸ ì‚­ì œ                                               â”‚
â”‚ âœ… ì‹œìŠ¤í…œ ê´€ë¦¬                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… ì±„íŒ… ì‚¬ìš©                                                  â”‚
â”‚ âœ… ì—ì´ì „íŠ¸ ëª©ë¡ ì¡°íšŒ                                          â”‚
â”‚ âœ… ì—ì´ì „íŠ¸ í™œì„±í™”/ë¹„í™œì„±í™” (ê°œì¸ ì„¤ì •)                          â”‚
â”‚ âŒ ì—ì´ì „íŠ¸ ë“±ë¡/ì‚­ì œ                                          â”‚
â”‚ âŒ ì‹œìŠ¤í…œ ê´€ë¦¬                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ í™˜ê²½ ë³€ìˆ˜

`.env` íŒŒì¼ì—ì„œ ë‹¤ìŒ ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•˜ì„¸ìš”:

```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=agent_orchestrator
DB_USER=your_username
DB_PASSWORD=your_password
```

## ğŸ› ï¸ ìœ ìš©í•œ ëª…ë ¹ì–´

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†
psql -d agent_orchestrator

# ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
SELECT * FROM users_with_roles;

# ì—ì´ì „íŠ¸ ìƒíƒœ í™•ì¸
SELECT name, url, status, last_seen FROM registered_agents;

# ëŒ€í™” ê¸°ë¡ ì¡°íšŒ
SELECT c.title, m.role, m.content, m.agent_used 
FROM conversations c 
JOIN messages m ON c.id = m.conversation_id 
ORDER BY m.created_at;
```






